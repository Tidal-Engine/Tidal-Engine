{
  "name": "Vulkan C++ Development Environment",
  "image": "mcr.microsoft.com/devcontainers/cpp",
  
  "features": {
    "ghcr.io/devcontainers/features/node:1": {
      "version": "lts"
    },
    "ghcr.io/anthropics/devcontainer-features/claude-code:1.0": {},
    "ghcr.io/devcontainers/features/common-utils:2": {
      "installZsh": true,
      "configureZshAsDefaultShell": true,
      "installOhMyZsh": true,
      "installOhMyZshConfig": true,
      "upgradePackages": true
    },
    "ghcr.io/devcontainers/features/git:1": {
      "ppa": true,
      "version": "latest"
    }
  },

  "customizations": {
    "vscode": {
      "extensions": [
        "ms-vscode.cpptools",
        "ms-vscode.cpptools-extension-pack",
        "ms-vscode.cmake-tools",
        "twxs.cmake",
        "ms-vscode.vscode-clangd",
        "llvm-vs-code-extensions.vscode-clangd",
        "vadimcn.vscode-lldb",
        "ms-vscode.test-adapter-converter",
        "editorconfig.editorconfig",
        "eamodio.gitlens",
        "mhutchie.git-graph",
        "gruntfuggly.todo-tree",
        "aaron-bond.better-comments",
        "streetsidesoftware.code-spell-checker",
        "ms-vscode.hexeditor",
        "ms-vscode.makefile-tools"
      ],
      "settings": {
        "C_Cpp.default.cppStandard": "c++23",
        "C_Cpp.default.intelliSenseMode": "linux-clang-x64",
        "C_Cpp.formatting": "clangFormat",
        "cmake.configureOnOpen": true,
        "cmake.generator": "Ninja",
        "clangd.path": "/usr/bin/clangd",
        "editor.formatOnSave": true,
        "editor.tabSize": 4,
        "editor.insertSpaces": true,
        "files.trimTrailingWhitespace": true,
        "terminal.integrated.defaultProfile.linux": "zsh"
      }
    }
  },

  "postCreateCommand": [
    "bash", "-c", 
    "sudo apt-get update && sudo apt-get install -y --no-install-recommends vulkan-tools vulkan-validationlayers vulkan-validationlayers-dev spirv-tools libvulkan-dev libglfw3-dev libglm-dev libxxf86vm-dev libxi-dev libxcursor-dev libxinerama-dev libxrandr-dev libassimp-dev libstb-dev libopenal-dev luajit-5.1-dev libluajit-5.1-dev libtbb-dev zstd libzstd-dev && sudo apt-get clean && sudo rm -rf /var/lib/apt/lists/* && sudo git clone https://github.com/Microsoft/vcpkg.git /opt/vcpkg && sudo /opt/vcpkg/bootstrap-vcpkg.sh && sudo ln -sf /opt/vcpkg/vcpkg /usr/local/bin/vcpkg && sudo chown -R vscode:vscode /opt/vcpkg"
  ],

  "remoteUser": "vscode",
  
  "capAdd": [
    "SYS_PTRACE"
  ],
  
  "securityOpt": [
    "seccomp:unconfined"
  ],

  "runArgs": [
    "--device=/dev/dri"
  ],

  "mounts": [
    "source=/tmp/.X11-unix,target=/tmp/.X11-unix,type=bind,consistency=cached"
  ],

  "containerEnv": {
    "DISPLAY": "${localEnv:DISPLAY}",
    "VULKAN_SDK": "/usr",
    "VK_LAYER_PATH": "/usr/share/vulkan/explicit_layer.d",
    "VCPKG_ROOT": "/opt/vcpkg",
    "VCPKG_DEFAULT_TRIPLET": "x64-linux",
    "PKG_CONFIG_PATH": "/usr/lib/x86_64-linux-gnu/pkgconfig:/usr/share/pkgconfig",
    "CC": "clang-18",
    "CXX": "clang++-18"
  },

  "workspaceFolder": "/workspaces/${localWorkspaceFolderBasename}",

  "forwardPorts": [],

  "portsAttributes": {},

  "otherPortsAttributes": {
    "onAutoForward": "notify"
  }
}